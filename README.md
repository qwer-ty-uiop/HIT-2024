# 2024HIT计算机网络实验二，可靠数据传输(GBN/SR协议的实现)

## 验收一

首先我实现了基于UDP的GBN协议，实现单向可靠数据传输  
其中，我是用了一个Random变量，用于模拟数据包的丢失，以此验证设计协议的有效性  
接下来我先演示。  
此时控制台输出数据包的发送时间、序列号、ACK、接收时间和序列号，超时重传等详细信息  
然后讲解GBN的要点：

- **重传机制**
    - 使用了Java中的Timer类，设置超时时间，在发送一个数据包时，如果这个数据包在滑动窗口的左端点，则启动计时器。当到达超时时间后，会自动执行里面的代码。这里的代码逻辑就是，将下一个传输的序列号sequence
      number重新设置为base，数据包集合指针packet iterator设置为base
      iterator，这样下一次的传输就会从base开始，重新发送窗口内的数据，这样就实现了全部重传。如果在超时时间内，发送方收到了大于base的ACK信号，那么发送方将会累计确认，并且重新开启计时器(
      如果累计确认后base == sequence number则停止计时，因为此时窗口内没有已经发送的数据包了)
- **ACK作用**
    - 确认接收到的数据包，并通知发送方发下一个数据包
    - 发送方累计确认，每次收到大于base的ACK就将base设置为(ACK+1)%SEQ_NUM，即下一个要传输的数据包的序号
- **模拟分组丢失**
    - 使用random模拟分组丢失，当random值 < LOSS_PROBABILITY 时视作此次传输的数据包丢包。
    - 丢包后发送方超时，Timer执行其中的代码，将nextSeqNum重设为base，在下一次传输的时候就会重新传输数据包。

## 验收二

验收二要改进验收一的GBN协议，实现双向传输，且能够传输文件。
此处我将GBN单独封装为了一个类，客户端和服务端只需创建GBN类的对象，并执行其中的函数就可以实现数据传输和接收。

- **控制台输出**
    - 包括数据包的发送，ACK，超时重传等内容
- **验证传输的可靠性**
    - 验证文件的内容一致

## 验收三

将GBN协议改为SR协议，传输速率增加  
实现滑动窗口和接收窗口，保证数据传输的正确性
